<!doctype html><html lang=en-us><head><title>Making a ZX Spectrum Game - Part 4 - Graphics | boblbobl</title>
<meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="My name is Lars Diget, and I’m a dad, husband, developer/architect, and amateur photographer. This blog intends to share any idea, thought, or inspiration, I might have, in the form of blog posts or photographs.
In my day job, I work for the best toy manufacturer in the world, LEGO®, creating digital experiences for kids of all ages. I’m primarily involved with projects in the initial phases, even before they are actual projects."><meta name=generator content="Hugo 0.120.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon></head><body class=single><nav class=navigation><a href=/ class=logo>boblbobl</a><ul class=menu><li><a href=/about>About</a></li></ul></nav><header class=profile><a href=/><img class=avatar alt=avatar src=/images/me.png></a><div>Lars Diget</div></header><main class=main><section id=single><h1 class=title>Making a ZX Spectrum Game - Part 4 - Graphics</h1><div class=tip><span>Dec 1, 2020 10:11
</span><span class=split>·
</span><span>537 words
</span><span class=split>·
</span><span>3 minute read</span></div><div class=content><p>I have now come to the point, where I would like to add a bit more graphics to the prototype. Instead of having basic characters act as standins for the graphics, why not do the actual graphics themselves. To start with, I would like to render a lime instead of the &ldquo;@&rdquo; character.</p><p>Before I can begin, I need to better understand the graphics capabilities of the ZX Spectrum and what options there are.</p><h2 id=a-zx-spectrum-graphics-primer>A ZX Spectrum Graphics Primer</h2><p>The ZX Spectrum had a screen resolution of 256×192 divided into 32×24 grid overlay where each 8x8 character block can contain only one foreground (Ink) - and one background (Paper) color. And speaking of colors, the ironically named ZX Spectrum only boost a color palette of 8 colors, or 16 if you also count the &ldquo;bright&rdquo; variants.</p><p>I wrote a small Sinclair BASIC program that showcase all the available colors of the ZX Spectrum.</p><p><figure><img src=/images/posts/colours.bas.png alt="Screenshot of all the 16 colors of the ZX Spectrum" title="Screenshot of all the 16 colors of the ZX Spectrum"><figcaption>Screenshot of all the 16 colors of the ZX Spectrum</figcaption></figure></p><p>The ZX Spectrum does not have any support for hardware sprites, but what it does have is the ability to create a user-defined graphics (UDG) characters, which in my case would work great for replacing the &ldquo;@&rdquo; character with an actual 8x8 graphic.</p><h2 id=designing-an-8x8-lime>Designing an 8x8 Lime</h2><p>Designing an UDG character is easy; take a 8x8 pixel grid, mark the pixels that represent the foreground (Ink), and convert that binary to decimal.</p><p><figure><img src=/images/posts/udg-lime.png alt="Illustration of creating a UDG character" title="Illustration of creating a UDG character"><figcaption>Illustration of creating a UDG character</figcaption></figure></p><p>Place those decimal numbers into a byte array and then reference that array from memory address 23675.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span>Dim udg (<span style=color:#ae81ff>7</span>) as uByte <span style=color:#f92672>=&gt;</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>102</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>126</span>, <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>0</span>}
</span></span><span style=display:flex><span>Poke uInteger <span style=color:#ae81ff>23675</span>, <span style=color:#960050;background-color:#1e0010>@</span>udg (<span style=color:#ae81ff>0</span>)
</span></span></code></pre></div><p>Instead of placing the &ldquo;@&rdquo; character, I can now instead place the CHR(144) which is the UDC characeter I just created:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span><span style=color:#66d9ef>PRINT</span> AT <span style=color:#66d9ef>INT</span>(<span style=color:#66d9ef>RND</span><span style=color:#f92672>*</span><span style=color:#ae81ff>20</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>,<span style=color:#66d9ef>INT</span>(<span style=color:#66d9ef>RND</span><span style=color:#f92672>*</span><span style=color:#ae81ff>31</span>);<span style=color:#66d9ef>CHR$</span>(<span style=color:#ae81ff>144</span>)
</span></span></code></pre></div><p>If I compile the prototype with these additions, I&rsquo;ll now see that the limes are rendered with the UDG character, I just created.</p><p><figure><img src=/images/posts/prototype-4.png alt="Screenshot of the prototype using UDG characters for graphics" title="Screenshot of the prototype using UDG characters for graphics"><figcaption>Screenshot of the prototype using UDG characters for graphics</figcaption></figure></p><p>However, the player don&rsquo;t collect any points when passing the limes on the screen. This is because the current check is based on whether the &ldquo;@&rdquo; character is on screen at that location:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span>If <span style=color:#66d9ef>SCREEN</span><span style=color:#960050;background-color:#1e0010>$</span>(y,x) <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;@&#34;</span> Then
</span></span><span style=display:flex><span>    updateScore(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    generateLimes(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>End If
</span></span></code></pre></div><p>I can however not make a check for <code>CHR$(144)</code> on <code>SCREEN$</code> position, instead I&rsquo;ll need to have a model of where the limes are located, which I&rsquo;ve done using an array the size of the play area on the screen (30 x 23).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span>Dim limes(<span style=color:#ae81ff>23</span>,<span style=color:#ae81ff>30</span>) as uByte
</span></span></code></pre></div><p>When I generate a new lime and place it on screen, I also mark it in the array.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span>Sub generateLimes(n as uByte)
</span></span><span style=display:flex><span>    Ink <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>    For l<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> To n
</span></span><span style=display:flex><span>        Let limeY <span style=color:#f92672>=</span> <span style=color:#66d9ef>INT</span>(<span style=color:#66d9ef>RND</span><span style=color:#f92672>*</span><span style=color:#ae81ff>20</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        Let limeX <span style=color:#f92672>=</span> <span style=color:#66d9ef>INT</span>(<span style=color:#66d9ef>RND</span><span style=color:#f92672>*</span><span style=color:#ae81ff>31</span>)
</span></span><span style=display:flex><span>        limes(limeY, limeX) <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        Print At limeY,limeX;<span style=color:#66d9ef>CHR$</span>(<span style=color:#ae81ff>144</span>)
</span></span><span style=display:flex><span>    Next l
</span></span><span style=display:flex><span>End Sub
</span></span></code></pre></div><p>With this in place I can check if there is a lime where the player is currently standing and update everything accordingly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-basic data-lang=basic><span style=display:flex><span>If limes(y,x) <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> Then
</span></span><span style=display:flex><span>    limes(y,x) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    updateScore(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    generateLimes(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>End If
</span></span></code></pre></div><p>Great, the prototype works as expected with wonderful new &ldquo;lime&rdquo; graphics. Next, I&rsquo;ll have a look at how to render the player and possibly use animations for when the player walks across the screen.</p></div><div class=tags><a href=https://boblbobl.com/tags/8-bit>8-bit</a>
<a href=https://boblbobl.com/tags/speccy>speccy</a>
<a href=https://boblbobl.com/tags/tutorial>tutorial</a>
<a href=https://boblbobl.com/tags/zx-spectrum>zx-spectrum</a></div></section></main><footer id=footer><span class=copyright>© Copyright
2023
</span><span>·</span>
<span class=powerby>Powered by <a href=http://www.gohugo.io/>Hugo</a>
</span><span>·</span>
<span class=theme>Theme Paper-Thin</span></footer></body></html>